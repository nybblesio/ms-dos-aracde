;ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
;³ banked                                            ³
;ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
;³                                                   ³
;³ copyright (C) 2017 jeff panici                    ³
;³ https://nybbles.io                                ³
;³                                                   ³
;³                                                   ³
;³                                                   ³
;ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

;ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
;³ variables                                         ³
;ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
mb_enabled      db  0
mb_action_flag  db  0
mb_result       db  0

;ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
;³ mb_draw                                           ³
;ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
_mb_draw:
    cmp     mb_enabled, 1
    je      >l0
    ret
l0: vg_fbox 50 by 33, 196 by 85, 8 by 0
    vg_box  50 by 33, 196 by 85, 0 by 0
    vg_fbox 52 by 35, 193 by 7,  9 by 0
    vg_str  micro_font, msgbox_title, 110 by 36, 7 by 0, 1
    xor     bx, bx
    xor     cx, cx
    mov     bh, 53
    mov     bl, 44
    mov     bp, msgbox_lines
l1: mov     cl, b[bp]
    cmp     cl, 0feh
    jne     >l3
    ret
l3: vg_str  micro_font, bp, bx, 7 by 0, 1
    add     bl, 6
    inc     bp
    add     bp, cx
    jmp     l1

mb_draw macro
    push    bp, ax, bx, cx, dx
    call    _mb_draw
    pop     dx, cx, bx, ax, bp
#em

mb_chk macro
    mov     al, 0
    cmp     mb_action_flag, 1
    jnz     >m1
m0: mov     al, 1
    mov     mb_action_flag, 0
    cmp     mb_result, 1
    jnz     >m1
    mov     mb_result, 0
    mov     al, 2
m1:
#em
